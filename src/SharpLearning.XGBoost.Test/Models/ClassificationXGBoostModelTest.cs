using System.Collections.Generic;
using System.IO;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using SharpLearning.Containers;
using SharpLearning.Containers.Matrices;
using SharpLearning.InputOutput.Csv;
using SharpLearning.Metrics.Classification;
using SharpLearning.XGBoost.Learners;
using SharpLearning.XGBoost.Models;

namespace SharpLearning.XGBoost.Test.Learners
{
    [TestClass]
    public class ClassificationXGBoostModelTest
    {
        readonly double m_delta = 0.0000001;

        [TestMethod]
        public void ClassificationXGBoostModel_Predict_Single()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var learner = CreateLearner();

            using (var sut = learner.Learn(observations, targets))
            {
                var rows = targets.Length;
                var predictions = new double[rows];
                for (int i = 0; i < rows; i++)
                {
                    predictions[i] = sut.Predict(observations.Row(i));
                }

                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(targets, predictions);

                Assert.AreEqual(0.17757009345794392, error, m_delta);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_Predict_Single_BinaryLogistic()
        {
            var parser = new CsvParser(() => new StringReader(DataSetUtilities.GlassData));
            var observations = parser.EnumerateRows(v => v != "Target").ToF64Matrix();

            var binaryTargets = parser.EnumerateRows("Target").ToF64Vector()
                .Select(v => v == 0 ? 0.0 : 1.0).ToArray();

            var rows = binaryTargets.Length;

            var learner = CreateLearner(ClassificationObjective.BinaryLogistic);
            using (var sut = learner.Learn(observations, binaryTargets))
            {
                var predictions = new double[rows];
                for (int i = 0; i < rows; i++)
                {
                    predictions[i] = sut.Predict(observations.Row(i));
                }

                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(binaryTargets, predictions);

                Assert.AreEqual(0.14953271028037382, error, m_delta);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_Predict_Multiple()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var learner = CreateLearner();

            using (var sut = learner.Learn(observations, targets))
            {
                var predictions = sut.Predict(observations);

                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(targets, predictions);

                Assert.AreEqual(0.17757009345794392, error, m_delta);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_PredictProbability_Single()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var learner = CreateLearner();
            using (var sut = learner.Learn(observations, targets))
            {
                var rows = targets.Length;
                var actual = new ProbabilityPrediction[rows];
                for (int i = 0; i < rows; i++)
                {
                    actual[i] = sut.PredictProbability(observations.Row(i));
                }

                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(targets, actual.Select(p => p.Prediction).ToArray());

                Assert.AreEqual(0.17757009345794392, error, m_delta);

                var expected = new ProbabilityPrediction[] { new(0, new Dictionary<double, double> { { 0, 0.204421937465668 }, { 1, 0.165088519454002 }, { 2, 0.169509157538414 }, { 3, 0.15365232527256 }, { 4, 0.15364582836628 }, { 5, 0.153682202100754 }, }), new(1, new Dictionary<double, double> { { 0, 0.212972953915596 }, { 1, 0.230104967951775 }, { 2, 0.149730339646339 }, { 3, 0.13572371006012 }, { 4, 0.135717958211899 }, { 5, 0.135750100016594 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(1, new Dictionary<double, double> { { 0, 0.212972953915596 }, { 1, 0.230104967951775 }, { 2, 0.149730339646339 }, { 3, 0.13572371006012 }, { 4, 0.135717958211899 }, { 5, 0.135750100016594 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.187391951680183 }, { 1, 0.240255907177925 }, { 2, 0.147197380661964 }, { 3, 0.141711086034775 }, { 4, 0.141705080866814 }, { 5, 0.141738638281822 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(1, new Dictionary<double, double> { { 0, 0.171550869941711 }, { 1, 0.17407751083374 }, { 2, 0.168291121721268 }, { 3, 0.162018626928329 }, { 4, 0.162011757493019 }, { 5, 0.162050127983093 }, }), new(0, new Dictionary<double, double> { { 0, 0.200587809085846 }, { 1, 0.200458511710167 }, { 2, 0.1540387570858 }, { 3, 0.1482974588871 }, { 4, 0.148291185498238 }, { 5, 0.14832629263401 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.209190428256989 }, { 1, 0.166168510913849 }, { 2, 0.160645022988319 }, { 3, 0.154657498002052 }, { 4, 0.154650956392288 }, { 5, 0.154687568545341 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.232574164867401 }, { 1, 0.15924671292305 }, { 2, 0.16351093351841 }, { 3, 0.14821520447731 }, { 4, 0.148208931088448 }, { 5, 0.148244023323059 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.231333449482918 }, { 1, 0.158397167921066 }, { 2, 0.16797336935997 }, { 3, 0.147424504160881 }, { 4, 0.147418275475502 }, { 5, 0.147453173995018 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.222247675061226 }, { 1, 0.191451728343964 }, { 2, 0.161376118659973 }, { 3, 0.141634315252304 }, { 4, 0.141628324985504 }, { 5, 0.14166185259819 }, }), new(1, new Dictionary<double, double> { { 0, 0.211069479584694 }, { 1, 0.217032581567764 }, { 2, 0.157594978809357 }, { 3, 0.134510651230812 }, { 4, 0.134504958987236 }, { 5, 0.145287364721298 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.221573829650879 }, { 1, 0.151714622974396 }, { 2, 0.20307545363903 }, { 3, 0.141204878687859 }, { 4, 0.141198918223381 }, { 5, 0.141232341527939 }, }), new(0, new Dictionary<double, double> { { 0, 0.218772485852242 }, { 1, 0.18845808506012 }, { 2, 0.163346409797668 }, { 3, 0.13941964507103 }, { 4, 0.139413744211197 }, { 5, 0.150589644908905 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.196985200047493 }, { 1, 0.201361879706383 }, { 2, 0.154732927680016 }, { 3, 0.148965761065483 }, { 4, 0.148959457874298 }, { 5, 0.148994728922844 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.22473056614399 }, { 1, 0.153876096010208 }, { 2, 0.157996505498886 }, { 3, 0.143216624855995 }, { 4, 0.143210560083389 }, { 5, 0.176969602704048 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.228362649679184 }, { 1, 0.156363025307655 }, { 2, 0.170506909489632 }, { 3, 0.14553128182888 }, { 4, 0.153676524758339 }, { 5, 0.145559579133987 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.231693357229233 }, { 1, 0.15864360332489 }, { 2, 0.162881851196289 }, { 3, 0.151451021432877 }, { 4, 0.147647619247437 }, { 5, 0.147682577371597 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.18250384926796 }, { 1, 0.232570126652718 }, { 2, 0.151334419846535 }, { 3, 0.15921525657177 }, { 4, 0.137171939015388 }, { 5, 0.137204423546791 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.185695022344589 }, { 1, 0.238080278038979 }, { 2, 0.154919907450676 }, { 3, 0.140427812933922 }, { 4, 0.140421867370605 }, { 5, 0.14045512676239 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.149003386497498 }, { 1, 0.251605868339539 }, { 2, 0.154151156544685 }, { 3, 0.14840567111969 }, { 4, 0.148399382829666 }, { 5, 0.148434519767761 }, }), new(1, new Dictionary<double, double> { { 0, 0.187391951680183 }, { 1, 0.240255907177925 }, { 2, 0.147197380661964 }, { 3, 0.141711086034775 }, { 4, 0.141705080866814 }, { 5, 0.141738638281822 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.161344453692436 }, { 1, 0.186508595943451 }, { 2, 0.161158725619316 }, { 3, 0.160697221755981 }, { 4, 0.160690426826477 }, { 5, 0.169600605964661 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(1, new Dictionary<double, double> { { 0, 0.149003386497498 }, { 1, 0.251605868339539 }, { 2, 0.154151156544685 }, { 3, 0.14840567111969 }, { 4, 0.148399382829666 }, { 5, 0.148434519767761 }, }), new(1, new Dictionary<double, double> { { 0, 0.154577597975731 }, { 1, 0.20810940861702 }, { 2, 0.175417006015778 }, { 3, 0.153957515954971 }, { 4, 0.15395100414753 }, { 5, 0.15398745238781 }, }), new(1, new Dictionary<double, double> { { 0, 0.14681002497673 }, { 1, 0.247902169823647 }, { 2, 0.166602239012718 }, { 3, 0.146221116185188 }, { 4, 0.146214917302132 }, { 5, 0.146249532699585 }, }), new(1, new Dictionary<double, double> { { 0, 0.149800211191177 }, { 1, 0.252951383590698 }, { 2, 0.149627774953842 }, { 3, 0.149199306964874 }, { 4, 0.149192988872528 }, { 5, 0.149228319525719 }, }), new(1, new Dictionary<double, double> { { 0, 0.164128586649895 }, { 1, 0.175637125968933 }, { 2, 0.169798880815506 }, { 3, 0.163470193743706 }, { 4, 0.163463264703751 }, { 5, 0.163501977920532 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.215209871530533 }, { 1, 0.221289947628975 }, { 2, 0.137543112039566 }, { 3, 0.140676274895668 }, { 4, 0.137143447995186 }, { 5, 0.148137360811234 }, }), new(1, new Dictionary<double, double> { { 0, 0.215209871530533 }, { 1, 0.221289947628975 }, { 2, 0.137543112039566 }, { 3, 0.140676274895668 }, { 4, 0.137143447995186 }, { 5, 0.148137360811234 }, }), new(1, new Dictionary<double, double> { { 0, 0.142483577132225 }, { 1, 0.228974625468254 }, { 2, 0.142319530248642 }, { 3, 0.164056032896042 }, { 4, 0.14190599322319 }, { 5, 0.18026028573513 }, }), new(1, new Dictionary<double, double> { { 0, 0.143185585737228 }, { 1, 0.230102762579918 }, { 2, 0.143020734190941 }, { 3, 0.16486431658268 }, { 4, 0.142605155706406 }, { 5, 0.176221489906311 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(1, new Dictionary<double, double> { { 0, 0.166896566748619 }, { 1, 0.175402864813805 }, { 2, 0.163720980286598 }, { 3, 0.167450442910194 }, { 4, 0.163245245814323 }, { 5, 0.16328389942646 }, }), new(4, new Dictionary<double, double> { { 0, 0.151807546615601 }, { 1, 0.159544795751572 }, { 2, 0.148919060826302 }, { 3, 0.152311354875565 }, { 4, 0.23889571428299 }, { 5, 0.148521512746811 }, }), new(1, new Dictionary<double, double> { { 0, 0.150330767035484 }, { 1, 0.237261682748795 }, { 2, 0.147470369935036 }, { 3, 0.150829672813416 }, { 4, 0.155278235673904 }, { 5, 0.158829256892204 }, }), new(1, new Dictionary<double, double> { { 0, 0.150330767035484 }, { 1, 0.237261682748795 }, { 2, 0.147470369935036 }, { 3, 0.150829672813416 }, { 4, 0.155278235673904 }, { 5, 0.158829256892204 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(0, new Dictionary<double, double> { { 0, 0.206467673182487 }, { 1, 0.166740626096725 }, { 2, 0.161198109388351 }, { 3, 0.155189976096153 }, { 4, 0.155183419585228 }, { 5, 0.155220150947571 }, }), new(1, new Dictionary<double, double> { { 0, 0.188319802284241 }, { 1, 0.239981546998024 }, { 2, 0.147029295563698 }, { 3, 0.14154925942421 }, { 4, 0.14154326915741 }, { 5, 0.141576781868935 }, }), new(1, new Dictionary<double, double> { { 0, 0.188319802284241 }, { 1, 0.239981546998024 }, { 2, 0.147029295563698 }, { 3, 0.14154925942421 }, { 4, 0.14154326915741 }, { 5, 0.141576781868935 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.164174765348434 }, { 1, 0.209589347243309 }, { 2, 0.16105517745018 }, { 3, 0.155052363872528 }, { 4, 0.155045807361603 }, { 5, 0.155082508921623 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(3, new Dictionary<double, double> { { 0, 0.149210333824158 }, { 1, 0.200883388519287 }, { 2, 0.149038568139076 }, { 3, 0.203621536493301 }, { 4, 0.148605495691299 }, { 5, 0.148640677332878 }, }), new(1, new Dictionary<double, double> { { 0, 0.166896566748619 }, { 1, 0.175402864813805 }, { 2, 0.163720980286598 }, { 3, 0.167450442910194 }, { 4, 0.163245245814323 }, { 5, 0.16328389942646 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(0, new Dictionary<double, double> { { 0, 0.205285787582397 }, { 1, 0.171510457992554 }, { 2, 0.160275369882584 }, { 3, 0.154301628470421 }, { 4, 0.154295101761818 }, { 5, 0.154331624507904 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(1, new Dictionary<double, double> { { 0, 0.19794899225235 }, { 1, 0.201120212674141 }, { 2, 0.154547214508057 }, { 3, 0.148786976933479 }, { 4, 0.148780673742294 }, { 5, 0.148815900087357 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.198042631149292 }, { 1, 0.202442809939384 }, { 2, 0.150195524096489 }, { 3, 0.14976541697979 }, { 4, 0.149759083986282 }, { 5, 0.149794533848763 }, }), new(0, new Dictionary<double, double> { { 0, 0.220375582575798 }, { 1, 0.189839035272598 }, { 2, 0.145878404378891 }, { 3, 0.16300305724144 }, { 4, 0.140435323119164 }, { 5, 0.140468567609787 }, }), new(0, new Dictionary<double, double> { { 0, 0.232574164867401 }, { 1, 0.15924671292305 }, { 2, 0.16351093351841 }, { 3, 0.14821520447731 }, { 4, 0.148208931088448 }, { 5, 0.148244023323059 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(1, new Dictionary<double, double> { { 0, 0.157011136412621 }, { 1, 0.211385697126389 }, { 2, 0.162435546517372 }, { 3, 0.156381294131279 }, { 4, 0.156374678015709 }, { 5, 0.156411692500114 }, }), new(0, new Dictionary<double, double> { { 0, 0.200586974620819 }, { 1, 0.161991447210312 }, { 2, 0.176644444465637 }, { 3, 0.150769785046577 }, { 4, 0.159208223223686 }, { 5, 0.150799110531807 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(2, new Dictionary<double, double> { { 0, 0.192420691251755 }, { 1, 0.161742717027664 }, { 2, 0.209272593259811 }, { 3, 0.145513951778412 }, { 4, 0.145507797598839 }, { 5, 0.145542249083519 }, }), new(0, new Dictionary<double, double> { { 0, 0.203436717391014 }, { 1, 0.165295079350471 }, { 2, 0.169711023569107 }, { 3, 0.153844580054283 }, { 4, 0.153838068246841 }, { 5, 0.15387450158596 }, }), new(0, new Dictionary<double, double> { { 0, 0.202308386564255 }, { 1, 0.164378300309181 }, { 2, 0.174316108226776 }, { 3, 0.152991309762001 }, { 4, 0.152984827756882 }, { 5, 0.153021052479744 }, }), new(2, new Dictionary<double, double> { { 0, 0.193465068936348 }, { 1, 0.15719299018383 }, { 2, 0.210408434271812 }, { 3, 0.146303743124008 }, { 4, 0.146297559142113 }, { 5, 0.146332189440727 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(0, new Dictionary<double, double> { { 0, 0.221237704157829 }, { 1, 0.190581694245338 }, { 2, 0.165187060832977 }, { 3, 0.140990674495697 }, { 4, 0.140984714031219 }, { 5, 0.141018092632294 }, }), new(0, new Dictionary<double, double> { { 0, 0.216337636113167 }, { 1, 0.186360627412796 }, { 2, 0.161528438329697 }, { 3, 0.160016357898712 }, { 4, 0.137862130999565 }, { 5, 0.13789476454258 }, }), new(3, new Dictionary<double, double> { { 0, 0.149128466844559 }, { 1, 0.163378983736038 }, { 2, 0.148956805467606 }, { 3, 0.206476286053658 }, { 4, 0.148523956537247 }, { 5, 0.183535546064377 }, }), new(3, new Dictionary<double, double> { { 0, 0.156232386827469 }, { 1, 0.167187243700027 }, { 2, 0.156052529811859 }, { 3, 0.209292829036713 }, { 4, 0.15559908747673 }, { 5, 0.15563590824604 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.14455483853817 }, { 1, 0.154690876603127 }, { 2, 0.144388437271118 }, { 3, 0.229516208171844 }, { 4, 0.143968880176544 }, { 5, 0.182880714535713 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.153719380497932 }, { 1, 0.164498031139374 }, { 2, 0.153542414307594 }, { 3, 0.209774866700172 }, { 4, 0.153096258640289 }, { 5, 0.165369004011154 }, }), new(3, new Dictionary<double, double> { { 0, 0.154578030109406 }, { 1, 0.160560995340347 }, { 2, 0.15440009534359 }, { 3, 0.214021503925323 }, { 4, 0.153951436281204 }, { 5, 0.16248793900013 }, }), new(3, new Dictionary<double, double> { { 0, 0.154578030109406 }, { 1, 0.160560995340347 }, { 2, 0.15440009534359 }, { 3, 0.214021503925323 }, { 4, 0.153951436281204 }, { 5, 0.16248793900013 }, }), new(3, new Dictionary<double, double> { { 0, 0.152724325656891 }, { 1, 0.160508275032043 }, { 2, 0.149818390607834 }, { 3, 0.238147541880608 }, { 4, 0.149383053183556 }, { 5, 0.14941842854023 }, }), new(1, new Dictionary<double, double> { { 0, 0.152712091803551 }, { 1, 0.20559786260128 }, { 2, 0.152536302804947 }, { 3, 0.176534190773964 }, { 4, 0.152093067765236 }, { 5, 0.160526528954506 }, }), new(3, new Dictionary<double, double> { { 0, 0.144403666257858 }, { 1, 0.194412112236023 }, { 2, 0.14423742890358 }, { 3, 0.229276165366173 }, { 4, 0.14381830394268 }, { 5, 0.143852367997169 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.152389481663704 }, { 1, 0.160156399011612 }, { 2, 0.149489924311638 }, { 3, 0.149061858654022 }, { 4, 0.23981149494648 }, { 5, 0.149090841412544 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.149491384625435 }, { 1, 0.163839146494865 }, { 2, 0.149319306015968 }, { 3, 0.148891717195511 }, { 4, 0.23953777551651 }, { 5, 0.148920670151711 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.142711848020554 }, { 1, 0.152718678116798 }, { 2, 0.142547562718391 }, { 3, 0.191180393099785 }, { 4, 0.228674560785294 }, { 5, 0.142167016863823 }, }), new(4, new Dictionary<double, double> { { 0, 0.151807546615601 }, { 1, 0.159544795751572 }, { 2, 0.148919060826302 }, { 3, 0.152311354875565 }, { 4, 0.23889571428299 }, { 5, 0.148521512746811 }, }), new(4, new Dictionary<double, double> { { 0, 0.151802018284798 }, { 1, 0.163394033908844 }, { 2, 0.148913636803627 }, { 3, 0.148487210273743 }, { 4, 0.238887012004852 }, { 5, 0.148516088724136 }, }), new(5, new Dictionary<double, double> { { 0, 0.14544840157032 }, { 1, 0.159347251057625 }, { 2, 0.145280972123146 }, { 3, 0.144864946603775 }, { 4, 0.144858822226524 }, { 5, 0.26019960641861 }, }), new(5, new Dictionary<double, double> { { 0, 0.158301413059235 }, { 1, 0.17342846095562 }, { 2, 0.158119171857834 }, { 3, 0.157666385173798 }, { 4, 0.157659709453583 }, { 5, 0.194824859499931 }, }), new(0, new Dictionary<double, double> { { 0, 0.219101145863533 }, { 1, 0.15002153813839 }, { 2, 0.200809195637703 }, { 3, 0.139629080891609 }, { 4, 0.139623180031776 }, { 5, 0.15081587433815 }, }), new(5, new Dictionary<double, double> { { 0, 0.158076956868172 }, { 1, 0.169161155819893 }, { 2, 0.157894983887672 }, { 3, 0.157442837953568 }, { 4, 0.157436162233353 }, { 5, 0.199987947940826 }, }), new(5, new Dictionary<double, double> { { 0, 0.161370471119881 }, { 1, 0.16959510743618 }, { 2, 0.158300027251244 }, { 3, 0.157846719026566 }, { 4, 0.157840043306351 }, { 5, 0.195047691464424 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.160495221614838 }, { 1, 0.168675243854523 }, { 2, 0.157441437244415 }, { 3, 0.156990587711334 }, { 4, 0.156983941793442 }, { 5, 0.199413493275642 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145015180110931 }, { 1, 0.158933326601982 }, { 2, 0.144848257303238 }, { 3, 0.144433453679085 }, { 4, 0.147345185279846 }, { 5, 0.259424567222595 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.146661177277565 }, { 1, 0.152337715029716 }, { 2, 0.1464923620224 }, { 3, 0.146072864532471 }, { 4, 0.146066680550575 }, { 5, 0.262369185686111 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.138151779770851 }, { 1, 0.147838860750198 }, { 2, 0.13799275457859 }, { 3, 0.191278502345085 }, { 4, 0.137591779232025 }, { 5, 0.24714632332325 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), };
                CollectionAssert.AreEqual(expected, actual);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_PredictProbability_Single_BinaryLogistic()
        {
            var parser = new CsvParser(() => new StringReader(DataSetUtilities.GlassData));
            var observations = parser.EnumerateRows(v => v != "Target").ToF64Matrix();

            var binaryTargets = parser.EnumerateRows("Target").ToF64Vector()
                .Select(v => v == 0 ? 0.0 : 1.0).ToArray();

            var rows = binaryTargets.Length;

            var learner = CreateLearner(ClassificationObjective.BinaryLogistic);
            using (var sut = learner.Learn(observations, binaryTargets))
            {
                var actual = new ProbabilityPrediction[rows];
                for (int i = 0; i < rows; i++)
                {
                    actual[i] = sut.PredictProbability(observations.Row(i));
                }

                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(binaryTargets, actual.Select(p => p.Prediction).ToArray());

                Assert.AreEqual(0.14953271028037382, error, m_delta);

                var expected = new ProbabilityPrediction[] { new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.505768656730652 }, { 1, 0.494231373071671 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.505768656730652 }, { 1, 0.494231373071671 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.505768656730652 }, { 1, 0.494231373071671 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.463839888572693 }, { 1, 0.536160111427307 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.463839888572693 }, { 1, 0.536160111427307 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.463839888572693 }, { 1, 0.536160111427307 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.427482306957245 }, { 1, 0.572517693042755 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.436939477920532 }, { 1, 0.563060522079468 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.436939477920532 }, { 1, 0.563060522079468 }, }), new(1, new Dictionary<double, double> { { 0, 0.436939477920532 }, { 1, 0.563060522079468 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.455988764762878 }, { 1, 0.544011235237122 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.455988764762878 }, { 1, 0.544011235237122 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.463839888572693 }, { 1, 0.536160111427307 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.455988764762878 }, { 1, 0.544011235237122 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(1, new Dictionary<double, double> { { 0, 0.457355201244354 }, { 1, 0.542644798755646 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.424107909202576 }, { 1, 0.575892090797424 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.427482306957245 }, { 1, 0.572517693042755 }, }), new(1, new Dictionary<double, double> { { 0, 0.427482306957245 }, { 1, 0.572517693042755 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(0, new Dictionary<double, double> { { 0, 0.536582946777344 }, { 1, 0.463417023420334 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.425627827644348 }, { 1, 0.574372172355652 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), new(1, new Dictionary<double, double> { { 0, 0.414723873138428 }, { 1, 0.585276126861572 }, }), };
                CollectionAssert.AreEqual(expected, actual);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_PredictProbability_Multiple()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var learner = CreateLearner();
            using (var sut = learner.Learn(observations, targets))
            {
                var rows = targets.Length;
                var actual = sut.PredictProbability(observations);
                var evaluator = new TotalErrorClassificationMetric<double>();
                var error = evaluator.Error(targets, actual.Select(p => p.Prediction).ToArray());

                Assert.AreEqual(0.17757009345794392, error, m_delta);

                var expected = new ProbabilityPrediction[] { new(0, new Dictionary<double, double> { { 0, 0.204421937465668 }, { 1, 0.165088519454002 }, { 2, 0.169509157538414 }, { 3, 0.15365232527256 }, { 4, 0.15364582836628 }, { 5, 0.153682202100754 }, }), new(1, new Dictionary<double, double> { { 0, 0.212972953915596 }, { 1, 0.230104967951775 }, { 2, 0.149730339646339 }, { 3, 0.13572371006012 }, { 4, 0.135717958211899 }, { 5, 0.135750100016594 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(1, new Dictionary<double, double> { { 0, 0.212972953915596 }, { 1, 0.230104967951775 }, { 2, 0.149730339646339 }, { 3, 0.13572371006012 }, { 4, 0.135717958211899 }, { 5, 0.135750100016594 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.187391951680183 }, { 1, 0.240255907177925 }, { 2, 0.147197380661964 }, { 3, 0.141711086034775 }, { 4, 0.141705080866814 }, { 5, 0.141738638281822 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(1, new Dictionary<double, double> { { 0, 0.171550869941711 }, { 1, 0.17407751083374 }, { 2, 0.168291121721268 }, { 3, 0.162018626928329 }, { 4, 0.162011757493019 }, { 5, 0.162050127983093 }, }), new(0, new Dictionary<double, double> { { 0, 0.200587809085846 }, { 1, 0.200458511710167 }, { 2, 0.1540387570858 }, { 3, 0.1482974588871 }, { 4, 0.148291185498238 }, { 5, 0.14832629263401 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.209190428256989 }, { 1, 0.166168510913849 }, { 2, 0.160645022988319 }, { 3, 0.154657498002052 }, { 4, 0.154650956392288 }, { 5, 0.154687568545341 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.232574164867401 }, { 1, 0.15924671292305 }, { 2, 0.16351093351841 }, { 3, 0.14821520447731 }, { 4, 0.148208931088448 }, { 5, 0.148244023323059 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.231333449482918 }, { 1, 0.158397167921066 }, { 2, 0.16797336935997 }, { 3, 0.147424504160881 }, { 4, 0.147418275475502 }, { 5, 0.147453173995018 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.222247675061226 }, { 1, 0.191451728343964 }, { 2, 0.161376118659973 }, { 3, 0.141634315252304 }, { 4, 0.141628324985504 }, { 5, 0.14166185259819 }, }), new(1, new Dictionary<double, double> { { 0, 0.211069479584694 }, { 1, 0.217032581567764 }, { 2, 0.157594978809357 }, { 3, 0.134510651230812 }, { 4, 0.134504958987236 }, { 5, 0.145287364721298 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.221573829650879 }, { 1, 0.151714622974396 }, { 2, 0.20307545363903 }, { 3, 0.141204878687859 }, { 4, 0.141198918223381 }, { 5, 0.141232341527939 }, }), new(0, new Dictionary<double, double> { { 0, 0.218772485852242 }, { 1, 0.18845808506012 }, { 2, 0.163346409797668 }, { 3, 0.13941964507103 }, { 4, 0.139413744211197 }, { 5, 0.150589644908905 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.236084789037704 }, { 1, 0.161650478839874 }, { 2, 0.15088452398777 }, { 3, 0.150452449917793 }, { 4, 0.150446087121964 }, { 5, 0.150481700897217 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.196985200047493 }, { 1, 0.201361879706383 }, { 2, 0.154732927680016 }, { 3, 0.148965761065483 }, { 4, 0.148959457874298 }, { 5, 0.148994728922844 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.233522072434425 }, { 1, 0.165416672825813 }, { 2, 0.154580771923065 }, { 3, 0.148819282650948 }, { 4, 0.148812994360924 }, { 5, 0.148848220705986 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(0, new Dictionary<double, double> { { 0, 0.22473056614399 }, { 1, 0.153876096010208 }, { 2, 0.157996505498886 }, { 3, 0.143216624855995 }, { 4, 0.143210560083389 }, { 5, 0.176969602704048 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.228362649679184 }, { 1, 0.156363025307655 }, { 2, 0.170506909489632 }, { 3, 0.14553128182888 }, { 4, 0.153676524758339 }, { 5, 0.145559579133987 }, }), new(0, new Dictionary<double, double> { { 0, 0.232576459646225 }, { 1, 0.159248277544975 }, { 2, 0.16350269317627 }, { 3, 0.148216664791107 }, { 4, 0.148210391402245 }, { 5, 0.148245483636856 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.231693357229233 }, { 1, 0.15864360332489 }, { 2, 0.162881851196289 }, { 3, 0.151451021432877 }, { 4, 0.147647619247437 }, { 5, 0.147682577371597 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.18250384926796 }, { 1, 0.232570126652718 }, { 2, 0.151334419846535 }, { 3, 0.15921525657177 }, { 4, 0.137171939015388 }, { 5, 0.137204423546791 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.185695022344589 }, { 1, 0.238080278038979 }, { 2, 0.154919907450676 }, { 3, 0.140427812933922 }, { 4, 0.140421867370605 }, { 5, 0.14045512676239 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.149003386497498 }, { 1, 0.251605868339539 }, { 2, 0.154151156544685 }, { 3, 0.14840567111969 }, { 4, 0.148399382829666 }, { 5, 0.148434519767761 }, }), new(1, new Dictionary<double, double> { { 0, 0.187391951680183 }, { 1, 0.240255907177925 }, { 2, 0.147197380661964 }, { 3, 0.141711086034775 }, { 4, 0.141705080866814 }, { 5, 0.141738638281822 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.161344453692436 }, { 1, 0.186508595943451 }, { 2, 0.161158725619316 }, { 3, 0.160697221755981 }, { 4, 0.160690426826477 }, { 5, 0.169600605964661 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(1, new Dictionary<double, double> { { 0, 0.149003386497498 }, { 1, 0.251605868339539 }, { 2, 0.154151156544685 }, { 3, 0.14840567111969 }, { 4, 0.148399382829666 }, { 5, 0.148434519767761 }, }), new(1, new Dictionary<double, double> { { 0, 0.154577597975731 }, { 1, 0.20810940861702 }, { 2, 0.175417006015778 }, { 3, 0.153957515954971 }, { 4, 0.15395100414753 }, { 5, 0.15398745238781 }, }), new(1, new Dictionary<double, double> { { 0, 0.14681002497673 }, { 1, 0.247902169823647 }, { 2, 0.166602239012718 }, { 3, 0.146221116185188 }, { 4, 0.146214917302132 }, { 5, 0.146249532699585 }, }), new(1, new Dictionary<double, double> { { 0, 0.149800211191177 }, { 1, 0.252951383590698 }, { 2, 0.149627774953842 }, { 3, 0.149199306964874 }, { 4, 0.149192988872528 }, { 5, 0.149228319525719 }, }), new(1, new Dictionary<double, double> { { 0, 0.164128586649895 }, { 1, 0.175637125968933 }, { 2, 0.169798880815506 }, { 3, 0.163470193743706 }, { 4, 0.163463264703751 }, { 5, 0.163501977920532 }, }), new(0, new Dictionary<double, double> { { 0, 0.223394736647606 }, { 1, 0.192439839243889 }, { 2, 0.157047867774963 }, { 3, 0.142365306615829 }, { 4, 0.142359286546707 }, { 5, 0.142392992973328 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(1, new Dictionary<double, double> { { 0, 0.165095925331116 }, { 1, 0.176672294735909 }, { 2, 0.164905861020088 }, { 3, 0.164433643221855 }, { 4, 0.164426684379578 }, { 5, 0.164465621113777 }, }), new(0, new Dictionary<double, double> { { 0, 0.226629555225372 }, { 1, 0.195226430892944 }, { 2, 0.144841581583023 }, { 3, 0.144426807761192 }, { 4, 0.144420698285103 }, { 5, 0.144454896450043 }, }), new(1, new Dictionary<double, double> { { 0, 0.215209871530533 }, { 1, 0.221289947628975 }, { 2, 0.137543112039566 }, { 3, 0.140676274895668 }, { 4, 0.137143447995186 }, { 5, 0.148137360811234 }, }), new(1, new Dictionary<double, double> { { 0, 0.215209871530533 }, { 1, 0.221289947628975 }, { 2, 0.137543112039566 }, { 3, 0.140676274895668 }, { 4, 0.137143447995186 }, { 5, 0.148137360811234 }, }), new(1, new Dictionary<double, double> { { 0, 0.142483577132225 }, { 1, 0.228974625468254 }, { 2, 0.142319530248642 }, { 3, 0.164056032896042 }, { 4, 0.14190599322319 }, { 5, 0.18026028573513 }, }), new(1, new Dictionary<double, double> { { 0, 0.143185585737228 }, { 1, 0.230102762579918 }, { 2, 0.143020734190941 }, { 3, 0.16486431658268 }, { 4, 0.142605155706406 }, { 5, 0.176221489906311 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(1, new Dictionary<double, double> { { 0, 0.166896566748619 }, { 1, 0.175402864813805 }, { 2, 0.163720980286598 }, { 3, 0.167450442910194 }, { 4, 0.163245245814323 }, { 5, 0.16328389942646 }, }), new(4, new Dictionary<double, double> { { 0, 0.151807546615601 }, { 1, 0.159544795751572 }, { 2, 0.148919060826302 }, { 3, 0.152311354875565 }, { 4, 0.23889571428299 }, { 5, 0.148521512746811 }, }), new(1, new Dictionary<double, double> { { 0, 0.150330767035484 }, { 1, 0.237261682748795 }, { 2, 0.147470369935036 }, { 3, 0.150829672813416 }, { 4, 0.155278235673904 }, { 5, 0.158829256892204 }, }), new(1, new Dictionary<double, double> { { 0, 0.150330767035484 }, { 1, 0.237261682748795 }, { 2, 0.147470369935036 }, { 3, 0.150829672813416 }, { 4, 0.155278235673904 }, { 5, 0.158829256892204 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(0, new Dictionary<double, double> { { 0, 0.206467673182487 }, { 1, 0.166740626096725 }, { 2, 0.161198109388351 }, { 3, 0.155189976096153 }, { 4, 0.155183419585228 }, { 5, 0.155220150947571 }, }), new(1, new Dictionary<double, double> { { 0, 0.188319802284241 }, { 1, 0.239981546998024 }, { 2, 0.147029295563698 }, { 3, 0.14154925942421 }, { 4, 0.14154326915741 }, { 5, 0.141576781868935 }, }), new(1, new Dictionary<double, double> { { 0, 0.188319802284241 }, { 1, 0.239981546998024 }, { 2, 0.147029295563698 }, { 3, 0.14154925942421 }, { 4, 0.14154326915741 }, { 5, 0.141576781868935 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.234818488359451 }, { 1, 0.160783424973488 }, { 2, 0.15543894469738 }, { 3, 0.149645462632179 }, { 4, 0.149639129638672 }, { 5, 0.149674564599991 }, }), new(1, new Dictionary<double, double> { { 0, 0.164174765348434 }, { 1, 0.209589347243309 }, { 2, 0.16105517745018 }, { 3, 0.155052363872528 }, { 4, 0.155045807361603 }, { 5, 0.155082508921623 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(1, new Dictionary<double, double> { { 0, 0.157896161079407 }, { 1, 0.21257720887661 }, { 2, 0.157714396715164 }, { 3, 0.157262772321701 }, { 4, 0.157256111502647 }, { 5, 0.15729333460331 }, }), new(3, new Dictionary<double, double> { { 0, 0.149210333824158 }, { 1, 0.200883388519287 }, { 2, 0.149038568139076 }, { 3, 0.203621536493301 }, { 4, 0.148605495691299 }, { 5, 0.148640677332878 }, }), new(1, new Dictionary<double, double> { { 0, 0.166896566748619 }, { 1, 0.175402864813805 }, { 2, 0.163720980286598 }, { 3, 0.167450442910194 }, { 4, 0.163245245814323 }, { 5, 0.16328389942646 }, }), new(1, new Dictionary<double, double> { { 0, 0.151579231023788 }, { 1, 0.239232078194618 }, { 2, 0.148695081472397 }, { 3, 0.152082279324532 }, { 4, 0.14826300740242 }, { 5, 0.160148292779922 }, }), new(0, new Dictionary<double, double> { { 0, 0.205285787582397 }, { 1, 0.171510457992554 }, { 2, 0.160275369882584 }, { 3, 0.154301628470421 }, { 4, 0.154295101761818 }, { 5, 0.154331624507904 }, }), new(1, new Dictionary<double, double> { { 0, 0.154403537511826 }, { 1, 0.247229039669037 }, { 2, 0.160873055458069 }, { 3, 0.145824074745178 }, { 4, 0.145817905664444 }, { 5, 0.14585243165493 }, }), new(1, new Dictionary<double, double> { { 0, 0.214853376150131 }, { 1, 0.232136651873589 }, { 2, 0.142222970724106 }, { 3, 0.13692207634449 }, { 4, 0.136916279792786 }, { 5, 0.136948689818382 }, }), new(1, new Dictionary<double, double> { { 0, 0.19794899225235 }, { 1, 0.201120212674141 }, { 2, 0.154547214508057 }, { 3, 0.148786976933479 }, { 4, 0.148780673742294 }, { 5, 0.148815900087357 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.190860792994499 }, { 1, 0.239230290055275 }, { 2, 0.146569013595581 }, { 3, 0.141106128692627 }, { 4, 0.141100153326988 }, { 5, 0.141133576631546 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(0, new Dictionary<double, double> { { 0, 0.225462421774864 }, { 1, 0.194221019744873 }, { 2, 0.149245649576187 }, { 3, 0.143683016300201 }, { 4, 0.143676936626434 }, { 5, 0.14371095597744 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.155869245529175 }, { 1, 0.249575912952423 }, { 2, 0.152907475829124 }, { 3, 0.147208347916603 }, { 4, 0.147202104330063 }, { 5, 0.147236958146095 }, }), new(1, new Dictionary<double, double> { { 0, 0.198042631149292 }, { 1, 0.202442809939384 }, { 2, 0.150195524096489 }, { 3, 0.14976541697979 }, { 4, 0.149759083986282 }, { 5, 0.149794533848763 }, }), new(0, new Dictionary<double, double> { { 0, 0.220375582575798 }, { 1, 0.189839035272598 }, { 2, 0.145878404378891 }, { 3, 0.16300305724144 }, { 4, 0.140435323119164 }, { 5, 0.140468567609787 }, }), new(0, new Dictionary<double, double> { { 0, 0.232574164867401 }, { 1, 0.15924671292305 }, { 2, 0.16351093351841 }, { 3, 0.14821520447731 }, { 4, 0.148208931088448 }, { 5, 0.148244023323059 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(0, new Dictionary<double, double> { { 0, 0.205473050475121 }, { 1, 0.16694962978363 }, { 2, 0.161400184035301 }, { 3, 0.155384510755539 }, { 4, 0.155377939343452 }, { 5, 0.15541473031044 }, }), new(1, new Dictionary<double, double> { { 0, 0.157011136412621 }, { 1, 0.211385697126389 }, { 2, 0.162435546517372 }, { 3, 0.156381294131279 }, { 4, 0.156374678015709 }, { 5, 0.156411692500114 }, }), new(0, new Dictionary<double, double> { { 0, 0.200586974620819 }, { 1, 0.161991447210312 }, { 2, 0.176644444465637 }, { 3, 0.150769785046577 }, { 4, 0.159208223223686 }, { 5, 0.150799110531807 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(2, new Dictionary<double, double> { { 0, 0.192420691251755 }, { 1, 0.161742717027664 }, { 2, 0.209272593259811 }, { 3, 0.145513951778412 }, { 4, 0.145507797598839 }, { 5, 0.145542249083519 }, }), new(0, new Dictionary<double, double> { { 0, 0.203436717391014 }, { 1, 0.165295079350471 }, { 2, 0.169711023569107 }, { 3, 0.153844580054283 }, { 4, 0.153838068246841 }, { 5, 0.15387450158596 }, }), new(0, new Dictionary<double, double> { { 0, 0.202308386564255 }, { 1, 0.164378300309181 }, { 2, 0.174316108226776 }, { 3, 0.152991309762001 }, { 4, 0.152984827756882 }, { 5, 0.153021052479744 }, }), new(2, new Dictionary<double, double> { { 0, 0.193465068936348 }, { 1, 0.15719299018383 }, { 2, 0.210408434271812 }, { 3, 0.146303743124008 }, { 4, 0.146297559142113 }, { 5, 0.146332189440727 }, }), new(0, new Dictionary<double, double> { { 0, 0.230239436030388 }, { 1, 0.157648086547852 }, { 2, 0.17190819978714 }, { 3, 0.146727308630943 }, { 4, 0.146721109747887 }, { 5, 0.14675584435463 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(2, new Dictionary<double, double> { { 0, 0.154068276286125 }, { 1, 0.164871394634247 }, { 2, 0.220686241984367 }, { 3, 0.153450235724449 }, { 4, 0.153443738818169 }, { 5, 0.15348008275032 }, }), new(0, new Dictionary<double, double> { { 0, 0.221237704157829 }, { 1, 0.190581694245338 }, { 2, 0.165187060832977 }, { 3, 0.140990674495697 }, { 4, 0.140984714031219 }, { 5, 0.141018092632294 }, }), new(0, new Dictionary<double, double> { { 0, 0.216337636113167 }, { 1, 0.186360627412796 }, { 2, 0.161528438329697 }, { 3, 0.160016357898712 }, { 4, 0.137862130999565 }, { 5, 0.13789476454258 }, }), new(3, new Dictionary<double, double> { { 0, 0.149128466844559 }, { 1, 0.163378983736038 }, { 2, 0.148956805467606 }, { 3, 0.206476286053658 }, { 4, 0.148523956537247 }, { 5, 0.183535546064377 }, }), new(3, new Dictionary<double, double> { { 0, 0.156232386827469 }, { 1, 0.167187243700027 }, { 2, 0.156052529811859 }, { 3, 0.209292829036713 }, { 4, 0.15559908747673 }, { 5, 0.15563590824604 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.14455483853817 }, { 1, 0.154690876603127 }, { 2, 0.144388437271118 }, { 3, 0.229516208171844 }, { 4, 0.143968880176544 }, { 5, 0.182880714535713 }, }), new(3, new Dictionary<double, double> { { 0, 0.150402143597603 }, { 1, 0.160948187112808 }, { 2, 0.150229007005692 }, { 3, 0.238800227642059 }, { 4, 0.149792477488518 }, { 5, 0.149827942252159 }, }), new(3, new Dictionary<double, double> { { 0, 0.153719380497932 }, { 1, 0.164498031139374 }, { 2, 0.153542414307594 }, { 3, 0.209774866700172 }, { 4, 0.153096258640289 }, { 5, 0.165369004011154 }, }), new(3, new Dictionary<double, double> { { 0, 0.154578030109406 }, { 1, 0.160560995340347 }, { 2, 0.15440009534359 }, { 3, 0.214021503925323 }, { 4, 0.153951436281204 }, { 5, 0.16248793900013 }, }), new(3, new Dictionary<double, double> { { 0, 0.154578030109406 }, { 1, 0.160560995340347 }, { 2, 0.15440009534359 }, { 3, 0.214021503925323 }, { 4, 0.153951436281204 }, { 5, 0.16248793900013 }, }), new(3, new Dictionary<double, double> { { 0, 0.152724325656891 }, { 1, 0.160508275032043 }, { 2, 0.149818390607834 }, { 3, 0.238147541880608 }, { 4, 0.149383053183556 }, { 5, 0.14941842854023 }, }), new(1, new Dictionary<double, double> { { 0, 0.152712091803551 }, { 1, 0.20559786260128 }, { 2, 0.152536302804947 }, { 3, 0.176534190773964 }, { 4, 0.152093067765236 }, { 5, 0.160526528954506 }, }), new(3, new Dictionary<double, double> { { 0, 0.144403666257858 }, { 1, 0.194412112236023 }, { 2, 0.14423742890358 }, { 3, 0.229276165366173 }, { 4, 0.14381830394268 }, { 5, 0.143852367997169 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.152389481663704 }, { 1, 0.160156399011612 }, { 2, 0.149489924311638 }, { 3, 0.149061858654022 }, { 4, 0.23981149494648 }, { 5, 0.149090841412544 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.149491384625435 }, { 1, 0.163839146494865 }, { 2, 0.149319306015968 }, { 3, 0.148891717195511 }, { 4, 0.23953777551651 }, { 5, 0.148920670151711 }, }), new(4, new Dictionary<double, double> { { 0, 0.150071501731873 }, { 1, 0.160594373941422 }, { 2, 0.149898752570152 }, { 3, 0.149469509720802 }, { 4, 0.240467309951782 }, { 5, 0.14949856698513 }, }), new(4, new Dictionary<double, double> { { 0, 0.142711848020554 }, { 1, 0.152718678116798 }, { 2, 0.142547562718391 }, { 3, 0.191180393099785 }, { 4, 0.228674560785294 }, { 5, 0.142167016863823 }, }), new(4, new Dictionary<double, double> { { 0, 0.151807546615601 }, { 1, 0.159544795751572 }, { 2, 0.148919060826302 }, { 3, 0.152311354875565 }, { 4, 0.23889571428299 }, { 5, 0.148521512746811 }, }), new(4, new Dictionary<double, double> { { 0, 0.151802018284798 }, { 1, 0.163394033908844 }, { 2, 0.148913636803627 }, { 3, 0.148487210273743 }, { 4, 0.238887012004852 }, { 5, 0.148516088724136 }, }), new(5, new Dictionary<double, double> { { 0, 0.14544840157032 }, { 1, 0.159347251057625 }, { 2, 0.145280972123146 }, { 3, 0.144864946603775 }, { 4, 0.144858822226524 }, { 5, 0.26019960641861 }, }), new(5, new Dictionary<double, double> { { 0, 0.158301413059235 }, { 1, 0.17342846095562 }, { 2, 0.158119171857834 }, { 3, 0.157666385173798 }, { 4, 0.157659709453583 }, { 5, 0.194824859499931 }, }), new(0, new Dictionary<double, double> { { 0, 0.219101145863533 }, { 1, 0.15002153813839 }, { 2, 0.200809195637703 }, { 3, 0.139629080891609 }, { 4, 0.139623180031776 }, { 5, 0.15081587433815 }, }), new(5, new Dictionary<double, double> { { 0, 0.158076956868172 }, { 1, 0.169161155819893 }, { 2, 0.157894983887672 }, { 3, 0.157442837953568 }, { 4, 0.157436162233353 }, { 5, 0.199987947940826 }, }), new(5, new Dictionary<double, double> { { 0, 0.161370471119881 }, { 1, 0.16959510743618 }, { 2, 0.158300027251244 }, { 3, 0.157846719026566 }, { 4, 0.157840043306351 }, { 5, 0.195047691464424 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145988583564758 }, { 1, 0.15622515976429 }, { 2, 0.145820543169975 }, { 3, 0.145402953028679 }, { 4, 0.145396813750267 }, { 5, 0.261165946722031 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.160495221614838 }, { 1, 0.168675243854523 }, { 2, 0.157441437244415 }, { 3, 0.156990587711334 }, { 4, 0.156983941793442 }, { 5, 0.199413493275642 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145015180110931 }, { 1, 0.158933326601982 }, { 2, 0.144848257303238 }, { 3, 0.144433453679085 }, { 4, 0.147345185279846 }, { 5, 0.259424567222595 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.146661177277565 }, { 1, 0.152337715029716 }, { 2, 0.1464923620224 }, { 3, 0.146072864532471 }, { 4, 0.146066680550575 }, { 5, 0.262369185686111 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.138151779770851 }, { 1, 0.147838860750198 }, { 2, 0.13799275457859 }, { 3, 0.191278502345085 }, { 4, 0.137591779232025 }, { 5, 0.24714632332325 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), new(5, new Dictionary<double, double> { { 0, 0.145561009645462 }, { 1, 0.155767604708672 }, { 2, 0.145393446087837 }, { 3, 0.14497709274292 }, { 4, 0.14789979159832 }, { 5, 0.260401040315628 }, }), };
                CollectionAssert.AreEqual(expected, actual);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_Save_Load()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var leaner = CreateLearner();
            var modelFilePath = "model.xgb";

            using (var sutPreSave = leaner.Learn(observations, targets))
            {
                AssertModel(observations, targets, sutPreSave);
                sutPreSave.Save(modelFilePath);
            }

            using (var sutAfterSave = ClassificationXGBoostModel.Load(modelFilePath))
            {
                AssertModel(observations, targets, sutAfterSave);
            }
        }

        [TestMethod]
        public void ClassificationXGBoostModel_GetVariableImportance()
        {
            var (observations, targets) = DataSetUtilities.LoadGlassDataSet();

            var index = 0;
            var name = "f";
            var featureNameToIndex = Enumerable.Range(0, 9)
                .ToDictionary(v => name + index.ToString(), v => index++);

            var learner = CreateLearner();

            using (var sut = learner.Learn(observations, targets))
            {
                var actual = sut.GetVariableImportance(featureNameToIndex);
                var expected = new Dictionary<string, double>
                {
                    { "f7", 100 },
                    { "f3", 96.65114317502 },
                    { "f2", 58.3335313859471 },
                    { "f6", 48.3923698786661 },
                    { "f0", 31.7452355441014 },
                    { "f8", 16.7766791437258 },
                    { "f5", 14.4376085200548 },
                    { "f1", 8.66713759744955 },
                    { "f4", 5.22468672931978 },
                };

                Assert.AreEqual(expected.Count, actual.Count);
                var zip = expected.Zip(actual, (e, a) => new { Expected = e, Actual = a });

                foreach (var item in zip)
                {
                    Assert.AreEqual(item.Expected.Key, item.Actual.Key);
                    Assert.AreEqual(item.Expected.Value, item.Actual.Value, m_delta);
                }
            }
        }

        static ClassificationXGBoostLearner CreateLearner(
            ClassificationObjective objective = ClassificationObjective.SoftProb)
        {
            return new ClassificationXGBoostLearner(maximumTreeDepth: 3,
                learningRate: 0.1,
                estimators: 2,
                silent: true,
                objective: objective,
                boosterType: BoosterType.GBTree,
                treeMethod: TreeMethod.Auto,
                numberOfThreads: -1,
                gamma: 0,
                minChildWeight: 1,
                maxDeltaStep: 0,
                subSample: 1,
                colSampleByTree: 1,
                colSampleByLevel: 1,
                l1Regularization: 0,
                l2Reguralization: 1,
                scalePosWeight: 1,
                baseScore: 0.5,
                seed: 0,
                missing: double.NaN);
        }

        void AssertModel(F64Matrix observations, double[] targets, ClassificationXGBoostModel model)
        {
            var predictions = model.Predict(observations);
            var evaluator = new TotalErrorClassificationMetric<double>();
            var actual = evaluator.Error(targets, predictions);

            Assert.AreEqual(0.17757009345794392, actual, m_delta);
        }
    }
}
